---
title: "Mental Health Attitudes and Work"
author: "Andrew Carson, Raphael Nash, Joel Park, Joy Payton, Walt Wells"
date: "May 25, 2018"
output:
  word_document: 
    toc: TRUE
    toc_depth: 4
  pdf_document: 
    toc: TRUE
    toc_depth: 4
---

# Abstract

Mental illness is a complex set of interrelated conditions that are gaining increasing awareness and acceptance as a legitimate health issue of interest to employers.  One organization, Open Sourcing Mental Illness, is focusing particularly on mental illness in the information worker community in the technological sector, particularly in the open source community.  In 2016, it administered a survey to 1400 respondents from the tech community that addressed a wide variety of questions about mental health, employment benefits and offerings, personal and perceived workplace attitudes in regard to mental health, and other demographic and related information.  Our team used this data set for our project.  After cleanup and transformation of variables, we built a model to predict whether an individual would seek professional mental health services using data submitted in the survey.  We built several models with differing sets of variables, but noted several important commonalities among successful models that were influential in predicting the seeking of professional mental health help.  In particular, an individual was more likely to seek help if their employer offered mental health benefits, if the employee was well informed about the options offered by the employer for treatment, if anonymity could be maintained when using mental health or substance abuse treatment resources, and if the employee believed mental health to be negatively affecting work productivity.  However, due to data limitations, such results should be applied to the tech community at large only with great caution.  More research is needed to confirm these results.

# Keywords

Mental illness, predictive modeling, workplace health, technology workers, health benefits

# Introduction

Open Sourcing Mental Illness (OSMI) is a non-profit organization that focuses on "raising awareness, educating, and providing resources to support mental wellness in the tech and open source communities" (Open Sourcing Mental Illness, 2018). It began in 2013 when Ed Finkler, a life long sufferer of mental illnesses, began speaking at technology conferences about his experiences with mental illness.  Due to the positive response he received, he has continued to speak and conduct research on mental illness in the technology community and to advocate for open discussion and support for those experiencing mental illness.  

As part of Finkler's research,  several surveys have been conducted relating to mental health in the technology sector.  A 2014 survey had 1200 responses and focused generally on mental health in the tech industry, while a revised 2016 survey had 1400 responses and focused on "attitudes towards mental health in the tech workplace" (Open Sourcing Mental Illness, 2018).  At the time of this writing, a 2017 survey was still in progress.

Given Finkler's desire to foster an open discussion about mental illness in the workplace, the raw survey data mentioned above is freely available for download.  Our team elected to use the most recent complete data, the 2016 survey data, for conducting our analysis.  It can be downloaded from an associated Kaggle site (OSMI Mental Health in Tech Survey 2016, 2018) or directly from the OSMI website.  

In addition to the data itself, OSMI has informational materials about workplace stressors, mental illness, and mental healh related costs.  Some of the data OSMI provides include the following information, which includes facts about their own data as well as about the scope of the impact of mental illness in the workplace (Talks & Videos, 2018):

  * About 1 in 5 people experience mental illness in the population at large
  * 60% of 1400 respondents to the survey had sought treatment for mental health conditions
  * 50% of 1400 respondents to the survey had been diagnosed with a mental illness
  * "High-pressure companies" have health care expenses 50% greater than others
  * "60-80% of workplace accidents are attributed to stress"
  * "Over 80% of doctor visits are stress-related"
  * More days of work are lost due to mental illness than other chronic conditions like asthma, arthritis, back pain, diabetes, heart disease, and hypertension
  * Over 70% of costs associated with mental illness are found in indirect costs of absenteeism, presenteism (at work but not full productive), turnover, and training costs for replacing workers.
  
Why does this matter?  To quote, "employees work harder when they are happy, and happy employees leads to less turnover, which ensures that operations run more smoothly" (Talks & Videos, 2018).  That is, there is a strong business case for addressing mental health in the workplace and providing support and medical care to those suffering from mental illness.  Such care and support creates a more productive and positive environment, and ultimately helps a company save on costs.


# Literature Review

Mental health issues are a global challenge for employers, with 20% of the workforce estimated to have moderate or severe mental illness (Memish 2017).  This is consistent with overall population prevalence estimates from regional health authorities and mental health organizations. NAMI suggests a prevalence rate in any given year of one in five, NIMH gives a rate just below that, at 18.3%, and the World Health Organization's surveys of mental health (WMH) give similar statistics for data collected from 28 countries  (National Alliance on Mental Illness 2018, National Institute of Mental Health 2016, Kessler 2009).  The range and impact of mental health disorders vary widely, ranging in severity from mild to severely impairing the daily activities of living for an individual.  The World Health Organization classifies the severity of mental disorders into mild, moderate, and serious categories, while the US National Institutes of Health has a nested taxonomy, using the terms "any mental illness" (AMI) and "serious mental illness" (SMI).   According to this ontology, AMI is defined as any "mental, behavioral, or emotional disorder" (National Institute of Mental Health 2017).  AMIs can include all levels of a disorder, from mild cases all the way to severe mental illness and impairment (National Institute of Mental Health 2017).  SMIs form a subset of AMIs and are described as "a mental, behavioral, or emotional disorder resulting in serious functional impairment" (National Institute of Mental Health 2017).  SMIs have major impacts on affected individuals, from interfering with daily living skills or activities to causing total or complete disability.  NIMH notes that "the burden of mental illnesses is particularly concentrated among those who experience disability due to SMI" (National Institute of Mental Health 2017).

With one-fifth of the working population affected by disorders such as depression and anxiety, it is unsurprising that the effects of mental health issues, whether transient or long-term, are costly not only to individuals, but to companies as well.  The International Labour Association estimated over a decade ago that the costs associated with mental health would continue to rise due to demographic changes and socioeconomic and violence-related stressors (International Labour Association, 2000).  While employee health is of critical importance to employers, few comprehensive guidelines exist to assist employers in setting up a robust system to deal with mental health issues and their consequences, with many employers relying only, or primarily, on an Employee Assistance Program (Page 2013, Memish 2017).  The ILA points out, however, that other workplace elements, including training, human resources policy, occupational health approaches, and managerial culture, are implicated in the success of workers with mental illness (International Labour Association, 2000).  In one of the rare randomized control trials on the subject, Millagan-Saville et al. demonstrated that supportive employer policies including positive managerial communication and practical support, have been demonstrated to have reduced worker absenteeism and be a worthwhile financial investment on the part of companies, which receive a modest return on investment (Milligan-Saville, 2017).  It is in an employer's best interests to maintain a healthy and satisfied staff.

Data from the 2016 SAMSHA survey includes the prevalence rates of mental illnesses among US adults. Not surprisingly, all races, genders, and age were affected by mental illness, with women affected at higher rates than men (NIMH 2018).  Particularly noteworthy is the fact that young and middle aged adults have the highest year prevalence rate of AMIs (over 21%), while older adults had markedly reduced rates of mental illness in a given year, at less than 15% (NIMH 2018).  This illustrates the importance of mental illness awareness in the workplace, as the principal workforce (by age) is the most profoundly affected by mental illness.

The serious impact of mental health disorders brings us to consider the topic of mental illness related mortality, specifically suicide and premature death caused by self-harm.  The majority of suicide deaths are attributable to depression, one of the most prevalent and fastest growing mental illnesses (International Labour Association, 2000).  Substance abuse is another costly and devastating consequence. Many individuals with mental health illnesses may attempt to cope with their struggles by using potentially hazardous and illicit pharmacological agents such as alcohol, narcotics, and benzodiazepines. Abuse of such agents can lead to long term medical health complications thus creating a vicious cycle of mental and physical health issues (Ma 2004).

Factors known to aggravate mental health include isolation, poor social support, burnout,	 and prolonged duration and high intensity levels of stress or trauma (Harvard Health Publishing 2017).  Perhaps unsurprisingly, high-stress career fields such as first responders and employees working rapidly changing, globalized sectors including those in the technology sector may tend to worsen mental health (Evans 2016, International Labour Association, 2000).   However, many individuals experiencing mental health struggles may feel pressured to not seek care or report their mental illnesses, as they may be afraid of being stigmatized, and as a result, mental illness in this workplace may likely be underreported, hidden, or kept secret, either at the time of experiencing symptoms or at a later date, such as returning to work after illness-related time off (International Labour Association, 2000).  

Despite a thorough search through Google Scholar and Pubmed, literature is sparse regarding mental health prevalence rates within the technology sector. One source, the Open Sourcing Mental Illness organization, has conducted surveys and attempted to collect and disseminate this information. By using this information, the authors have hoped to use preliminary information to analyze mental health influencers and produce more research in this ill-defined field. By performing rigorous data analysis and regression, we, as data scientists, hope to clarify any underlying patterns that exist in mental health illnesses within the technology industry.



# Methodology
## The Dataset

The data here is taken from https://www.kaggle.com/osmi/mental-health-in-tech-survey, which in turn was generated from the [Open Sourcing Mental Illness project](https://osmihelp.org/) (OSMI), which describes itself as "a non-profit, 501(c)(3) corporation dedicated to raising awareness, educating, and providing resources to support mental wellness in the tech and open source communities".  OSMI conducted survey-based research in 2014, 2016, and 2017, to collect data about professionals in the open source developer community and research their openness to accessing mental health resources.  The data we're using in this analysis comes from the 2016 survey results.  

## Limitations of the Data

Before beginning the analysis, it should be noted that the data has limitations for scientific analysis.  The survey data was collected anonymously without identifying information.  As such, it relies on the honest reporting of respondents and cannot be verified for accuracy.  It was offered in English only and may exclude non-native English speakers through self-exclusion.  There was no tracking of the population, and a respondent could have answered multiple times.  Other self selection likely occured (e.g., North American, interested in and engaged in mental health topics) and as such, it is difficult to know what biases in the sample exist relative to the population of tech employees.  Finally, the information in the survey about the employers comes from the employees filling out the survey and may be innaccurate from the perspective of the employer.  Consequently, given these limitations in the data, any results derived from studying the survey must be held tentatively and applied only to those who in fact responded to the survey.  Application to the tech community in general must be done so with great caution, and further research is needed in order to generalize these results.


## Data Summary

Let's take a quick peek at our data to diagnose any prima facie errors or issues.  The data is 307.5 Kb in size. There are 1,259 rows and 27 columns (features). Of all 27 columns, 26 are discrete, 1 is continuous. There are 1,892 missing values out of 33,993 data points.

## Independent Variables

While only 13% of the comments are populated, the comments field is fascinating and ripe for text analysis.   To make useful, the field would need to be further prepared using NLP and features would need to be prepared for any regression to be done.  The timestamp field has been converted to the appropriate object type. 

Our Age variable has some clear and impossible outliers.  There are multiple values < 18 (even some negative numbers) and some values > 200 years old.  Instead of replacing these, we set to NA and reviewed in the imputation process. We'll set the maximum reasonable age at 100, to accommodate any additional data that could potentially be added (e.g. from other years of the same survey).  Our minimum age will be 18, which allows us to know that we're conducting our analyses on adults (for human subjects protections reasons).  We'll remove the age from unrealistic measurements (like -1726 or 329, which are clearly impossible, and 5 or 11, which are too young to be able to be employed), and remove the entire row where the age is between 13 and 17, inclusive.  While there are currently no rows that seem to represent this underage teenager demographic, we add this out of an abundance of caution and to enable code reuse and reproducibility on similar datasets.

Gender is more interesting and complex in this dataset.   We trimmed down a very long list of self-reported gender by doing some rough matching and cleaning.  We see that there are some typos, some differences in capitalization, some differences in terminology ("woman" vs. "female"), some specifiers ("Cis" / "trans", some non-binary options, and some ambiguous answers.  We'll handle this by consolidating multiple terms into overarching categories and re-assigning common labels to each row.

## NA Handling

We have five variables with NAs - comments, state, work_interfere, self_employed, and age.   As noted earlier, without further feature creation, we'll exclude the comments variable entirely.  

Most of our missing values are for US States.   While it's fine for this to be missing if it's a non-US country, we conducted an additional study that showed that while that was mostly happening, there were also some additional issues that needed to be fixed.   This included having states associated with non-US countries (eg - Latvia, NY or Israel, MD).  In addition, since country and state were proving to be non-uniform, we leveraged the great country code R package to create a "continent" feature that can easily be included in the regression.

The work_interfere variable is a response to the question: "If you have a mental health condition, do you feel that it interferes with your work?"   I would suggest two possibile interpretations:

1)   "I do not have a mental health condition"
2)   "I don't want to respond about how my work is affected"

Since the treatment variable is pretty evenly split (No=622/Yes=637) on whether they've sought treatment for a mental health condition, it may not always be option 1.   Since we have no way of knowing which condition is likely, let's simply add a 5th category for "No Response"

For the remaining two fields (self_employed and age), since we will only lose 26 observations, let's simply remove those observations.  With this, our data is roughly ready for experimentation and modeling.   

# Experimentation and Model Building
## Model building

The goal of the model that we are building is to predict if an employee is going to seek mental health treatment, and this is going to depend on the circumstances at an employee work place.  

The type of model that we are going to build is a logistic logit model.   This is because we are predicting a binary output: will the person seek mental health treatment or not?   

The method of model building that we are going to use is start with all the data, then drop variables that are not significant, build the model again and repeat.  

To begin, we will drop the 'state' field from the dataset, since over 50% of the values for state are not populated. We will also drop the Timestamp field as this is just the timestamp of when the user filled out the survey.  

## Model 1 

This model will predict if someone will seek mental health care based on all other variables in the dataset with the exception of `state`.  

Here are the coefficents of this model.  Note that some colinearity of variables causes matrix singularities and corresponding NA values in the table for four variables.

|         Variable             |Estimate |Std. Error |z value |Pr(>\|z\|)   
|------------------------------|---------|-----------|--------|---------- 
|(Intercept)                   |-8.216e+01  |3.595e+01  |-2.285  |0.02228 *  
|Timestamp                      |5.606e-08  |2.548e-08   |2.200  |0.02779 *  
|Age                            |2.490e-02  |1.324e-02   |1.880  |0.06014 .  
|Genderfemale_trans            |-7.312e-01  |1.185e+00  |-0.617  |0.53710    
|Genderfluid                   |-1.635e+00  |1.252e+00  |-1.306  |0.19148    
|Gendergenderqueer              |8.869e-01  |1.221e+00   |0.727  |0.46751    
|Gendermale_cis                |-7.113e-01  |2.480e-01  |-2.868  |0.00413 ** 
|Genderunknown                  |1.483e+01  |3.956e+03   |0.004  |0.99701    
|CountryAustria                |-1.695e+01  |1.679e+03  |-0.010  |0.99194    
|CountryBelgium                |-1.735e+00  |1.624e+00  |-1.068  |0.28550    
|CountryBosnia and Herzegovina |-1.841e+01  |3.956e+03  |-0.005  |0.99629    
|CountryBrazil                  |1.656e-01  |1.431e+00   |0.116  |0.90791    
|CountryBulgaria                |3.516e+00  |2.829e+00   |1.243  |0.21387    
|CountryCanada                  |1.155e-01  |7.498e-01   |0.154  |0.87758    
|CountryChina                  |-1.706e+01  |3.956e+03  |-0.004  |0.99656    
|CountryColombia               |-1.760e+01  |2.781e+03  |-0.006  |0.99495    
|CountryCosta Rica             |-1.357e+01  |3.956e+03  |-0.003  |0.99726    
|CountryCroatia                 |1.558e+01  |2.705e+03   |0.006  |0.99540    
|CountryCzech Republic         |-2.031e+01  |3.956e+03  |-0.005  |0.99590    
|CountryDenmark                 |1.645e+01  |2.797e+03   |0.006  |0.99531    
|CountryFinland                 |1.534e-01  |2.869e+00   |0.053  |0.95735    
|CountryFrance                  |7.050e-01  |1.435e+00   |0.491  |0.62335    
|CountryGeorgia                |-1.738e+01  |3.956e+03  |-0.004  |0.99649    
|CountryGermany                 |1.789e-01  |7.962e-01   |0.225  |0.82218    
|CountryGreece                 |-1.277e+01  |2.759e+03  |-0.005  |0.99631    
|CountryHungary                |-1.813e+01  |3.956e+03  |-0.005  |0.99634    
|CountryIndia                   |1.125e+00  |1.325e+00   |0.849  |0.39585    
|CountryIreland                |-8.187e-02  |8.529e-01  |-0.096  |0.92354    
|CountryIsrael                 |-1.642e+01  |1.469e+03  |-0.011  |0.99108    
|CountryItaly                  |-1.327e+00  |1.366e+00  |-0.972  |0.33121    
|CountryJapan                   |1.606e+01  |3.956e+03   |0.004  |0.99676    
|CountryLatvia                 |-1.240e+01  |3.956e+03  |-0.003  |0.99750    
|CountryMexico                  |1.777e+00  |2.461e+00   |0.722  |0.47034    
|CountryMoldova                 |1.379e+01  |3.956e+03   |0.003  |0.99722    
|CountryNetherlands            |-4.686e-01  |8.721e-01  |-0.537  |0.59104    
|CountryNew Zealand             |3.601e-02  |1.130e+00   |0.032  |0.97458    
|CountryNigeria                |-1.279e+01  |3.956e+03  |-0.003  |0.99742    
|CountryNorway                 |-1.456e+01  |3.956e+03  |-0.004  |0.99706    
|CountryPhilippines            |-1.835e+01  |3.956e+03  |-0.005  |0.99630    
|CountryPoland                  |5.475e-02  |1.141e+00   |0.048  |0.96174    
|CountryPortugal               |-1.389e+01  |2.627e+03  |-0.005  |0.99578    
|CountryRomania                |-1.182e+01  |3.956e+03  |-0.003  |0.99762    
|CountryRussia                 |-1.602e+01  |2.022e+03  |-0.008  |0.99368    
|CountrySingapore              |-1.338e+00  |1.501e+00  |-0.892  |0.37245    
|CountrySlovenia                |1.843e+01  |3.956e+03   |0.005  |0.99628    
|CountrySouth Africa            |1.690e+00  |1.925e+00   |0.878  |0.37983    
|CountrySpain                  |-1.340e+01  |3.956e+03  |-0.003  |0.99730    
|CountrySweden                 |-1.610e+00  |1.311e+00  |-1.228  |0.21931    
|CountrySwitzerland             |1.180e+00  |1.427e+00   |0.827  |0.40828    
|CountryThailand               |-1.456e+01  |3.956e+03  |-0.004  |0.99706    
|CountryUnited Kingdom          |7.107e-01  |6.862e-01   |1.036  |0.30030    
|CountryUnited States           |1.793e-01  |6.642e-01   |0.270  |0.78720    
|CountryUruguay                |-1.227e+01  |3.956e+03  |-0.003  |0.99753    
|self_employedYes              |-2.977e-01  |3.543e-01  |-0.840  |0.40084    
|family_historyYes              |1.002e+00  |1.919e-01   |5.221 |1.78e-07 ***
|work_interfereNo Response     |-2.534e+00  |5.709e-01  |-4.439 |9.05e-06 ***
|work_interfereOften            |3.571e+00  |3.743e-01   |9.540  |< 2e-16 ***
|work_interfereRarely           |2.539e+00  |3.050e-01   |8.325  |< 2e-16 ***
|work_interfereSometimes        |2.960e+00  |2.715e-01  |10.904  |< 2e-16 ***
|no_employees100-500            |2.208e-01  |4.111e-01   |0.537  |0.59126    
|no_employees26-100             |2.780e-01  |3.750e-01   |0.741  |0.45855    
|no_employees500-1000           |1.611e-01  |5.637e-01   |0.286  |0.77505    
|no_employees6-25               |1.093e-01  |3.514e-01   |0.311  |0.75582    
|no_employeesMore than |1000    |-1.209e-01  |4.134e-01  |-0.292  |0.76992    
|remote_workYes                |-2.171e-01  |2.168e-01  |-1.001  |0.31679    
|tech_companyYes               |-1.188e-01  |2.538e-01  |-0.468  |0.63964    
|benefitsNo                     |2.747e-01  |2.890e-01   |0.951  |0.34184    
|benefitsYes                    |8.175e-01  |2.862e-01   |2.857  |0.00428 ** 
|care_optionsNot sure          |-1.570e-01  |2.475e-01  |-0.634  |0.52592    
|care_optionsYes                |7.424e-01  |2.562e-01   |2.898  |0.00375 ** 
|wellness_programNo            |-1.667e-01  |3.197e-01  |-0.522  |0.60197    
|wellness_programYes           |-5.120e-01  |3.772e-01  |-1.357  |0.17473    
|seek_helpNo                   |-6.722e-01  |2.681e-01  |-2.507  |0.01216 *  
|seek_helpYes                  |-8.626e-01  |3.310e-01  |-2.606  |0.00917 ** 
|anonymityNo                   |-1.645e-01  |4.286e-01  |-0.384  |0.70107    
|anonymityYes                   |5.586e-01  |2.472e-01   |2.259  |0.02387 *  
|leaveSomewhat difficult        |4.963e-01  |3.313e-01   |1.498  |0.13420    
|leaveSomewhat easy            |-2.752e-01  |2.440e-01  |-1.128  |0.25936    
|leaveVery difficult            |3.938e-01  |3.743e-01   |1.052  |0.29278    
|leaveVery easy                 |1.501e-01  |2.998e-01   |0.501  |0.61652    
|mental_health_consequenceNo   |-6.074e-02  |2.595e-01  |-0.234  |0.81493    
|mental_health_consequenceYes  |-1.733e-01  |2.666e-01  |-0.650  |0.51580    
|phys_health_consequenceNo      |8.976e-02  |2.462e-01   |0.365  |0.71547    
|phys_health_consequenceYes    |-2.202e-03  |4.845e-01  |-0.005  |0.99637    
|coworkersSome of them          |3.955e-01  |2.589e-01   |1.528  |0.12658    
|coworkersYes                   |1.078e+00  |3.795e-01   |2.840  |0.00451 ** 
|supervisorSome of them        |-4.168e-01  |2.569e-01  |-1.623  |0.10467    
|supervisorYes                 |-3.558e-01  |2.983e-01  |-1.193  |0.23295    
|mental_health_interviewNo      |3.469e-01  |3.089e-01   |1.123  |0.26140    
|mental_health_interviewYes     |9.515e-01  |6.762e-01   |1.407  |0.15943    
|phys_health_interviewNo        |1.385e-01  |2.156e-01   |0.642  |0.52056    
|phys_health_interviewYes       |4.248e-01  |3.029e-01   |1.403  |0.16071    
|mental_vs_physicalNo          |-1.025e-01  |2.425e-01  |-0.423  |0.67258    
|mental_vs_physicalYes         |-2.825e-02  |2.585e-01  |-0.109  |0.91298    
|obs_consequenceYes             |2.960e-01  |2.843e-01   |1.041  |0.29768    
|continentAmericas               |      NA     |    NA  |    NA  |     NA    
|continentAsia                   |     NA      |  NA    | NA     | NA    
|continentEurope                 |     NA      |  NA    | NA     | NA    
|continentOceania                |     NA      |  NA    | NA     | NA    


`Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1`

The AIC of the Model is 1020 and the area under the ROC curve is .9253

## Model 2

To build this model we are going to start with model1 and drop all of the variables that have a p-value of greater than .1.  The variables for this model are:  `Age`, `Gender`, `work_interfere` (amount of work interference of the mental health issue), `family_history` (whether the person has a family history of mental health issues), `benefits` (whether the employer provides mental health benefits),  `care_options` (whether the person knows about care options), `anonymity` (whether the person can stay anonymous), and `coworkers` (whether the person has coworkers they can talk to).

The coefficients for this model are:  

|         Variable             |Estimate |Std. Error |z value |Pr(>|z|)   
|------------------------------|---------|-----------|--------|---------- 
 Coefficients:
 Estimate Std. Error z value Pr(>|z|)
 (Intercept) -2.86067 0.51261 -5.581 2.40e-08 ***
 Age 0.02308 0.01142 2.021 0.043305 *
 Genderfemale_trans -0.51100 1.16244 -0.440 0.660233
 Genderfluid -0.68534 1.23932 -0.553 0.580264
 Gendergenderqueer 0.65882 1.10910 0.594 0.552502
 Gendermale_cis -0.75196 0.22689 -3.314 0.000919 ***
 Genderunknown 10.71894 535.41126 0.020 0.984027
 family_historyYes 0.98156 0.17544 5.595 2.21e-08 ***
 work_interfereNo Response -2.35093 0.55073 -4.269 1.97e-05 ***
 work_interfereOften 3.38019 0.33485 10.095 < 2e-16 ***
 work_interfereRarely 2.44761 0.28372 8.627 < 2e-16 ***
 work_interfereSometimes 2.82398 0.24920 11.332 < 2e-16 ***
 benefitsNo -0.06002 0.23089 -0.260 0.794915
 benefitsYes 0.48226 0.24500 1.968 0.049027 *
 care_optionsNot sure -0.15089 0.22230 -0.679 0.497299
 care_optionsYes 0.53490 0.22423 2.385 0.017056 *
 anonymityNo -0.02996 0.36986 -0.081 0.935449
 anonymityYes 0.30273 0.21200 1.428 0.153297
 coworkersSome of them 0.21571 0.20477 1.053 0.292147
 coworkersYes 0.84316 0.28387 2.970 0.002975 **


The AIC is 953 and the area under the curve is .0.91

## Model 3

For model 3, we take the variables with a pvalue of 0.1 or higher from model1 and use them to predict if an employee will seek treatment.  These variables include are the amount of interference from work that the issue causes (`work_interfere`), employer provides mental health benefits (`benefits`), know the care options (`care_options`), and stay anonymous (`anonymity`).  

The coeffecients of this model are: 


|         Variable             |Estimate |Std. Error |z value |Pr(>|z|)   
|------------------------------|---------|-----------|--------|----------    
 Coefficients:
 Estimate Std. Error z value Pr(>|z|)
 (Intercept) -2.2549 0.2625 -8.592 < 2e-16 ***
 work_interfereNo Response -2.3615 0.5453 -4.331 1.49e-05 ***
 work_interfereOften 3.5817 0.3206 11.173 < 2e-16 ***
 work_interfereRarely 2.6143 0.2705 9.665 < 2e-16 ***
 work_interfereSometimes 3.0312 0.2372 12.779 < 2e-16 ***
 benefitsNo -0.1679 0.2202 -0.763 0.44565
 benefitsYes 0.6218 0.2323 2.677 0.00743 **
 care_optionsNot sure -0.1033 0.2127 -0.486 0.62703
 care_optionsYes 0.5672 0.2156 2.631 0.00852 **
 anonymityNo -0.0199 0.3481 -0.057 0.95440
 anonymityYes 0.3432 0.2028 1.692 0.09056 .
 


`Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1`

The AIC is   996 and the Area under the curve is  0.8913

## Summary of Results

Model 1, the model with all the variables, has the highest area under the curve, but also the highest AIC.  Model 3 has the second lowest AIC but the lowest AUC.  Model 2 has the lowest AIC and the second highest AUC and is probably the best model in terms of balancing predictive power with simplicity.

In summary, this is a very well-designed survey for predicting if a person is going to get treatment for mental health.  Also, if you are an employer and you want to encourage you employees to seek treatment for mental health care, the things you can do are the following:

1)	Provide Benefits
2)	Make sure the person knows the care options
3)	Make sure the person can stay anonymous

Also, the most personally influential factor if someone is going to seek help is if the mental illness interferes with work.  

The biggest surprise in the data, is that if the employer provides resource or a wellness program they do not predict very well if the person is going to seek treatment.  We surmise that is probably because people want to stay anonymous if they seek mental health treatment.  

# Final Discussion and Conclusions

In each model, the significant variables align with our expectations.  If work interferes at all (and especially often), this positively correlates with obtaining treatment whereas "no response" correlates negatively with treatment.  Clearly, if the illness is impacting one's life negatively, one will be more inclined to receive treatment.  Having a family history of mental illness is positively correlated with obtaining treatment.  Likely, one will be more aware of mental illness or more accepting of it as a legitimate health concern. Having benefits provided by the employer makes one more likely to have treatment, as one will likely not need to pay as much for treatment and so there is a lower barrier to treatment.  Similarly, having care options makes one more likely to obtain treatment.  Anonymity is positively correlated while no anonymity is negatively correlated, as we would expect if people are embarrased, ashamed, or otherwise disinclined to make their mental illness known to others, and seeking treatment would make this illness known.  Knowing coworkers that have the same struggle also positively correlates with treatment, as perhaps this is already an environment where people are more aware of mental illness and accepting of it.

As the insignificant variables are removed, the coefficients do not change significantly, suggesting that we have captured the signal in the data for predicting whether an employee will seek treatment.  And while Model1 certainly does the best job at explaining and predicting with a deviance R^2 of 0.51, it is not much better than the other models.  Model2 has a deviance R^2 of  0.46, and Model3 has a deviance R^2 of 0.43.  

We have already noted many limitations in the data, the method of collection, and so forth.  However, there does appear to be some insights that can be gathered from the data as mentioned above.  As such, for conclusions that are more robust and can generalize broadly, further research is needed that address the limitations.  In particular, a more scientific study should be conducted across the tech sector using more observations, random sampling techniques, and so forth.  We expect that this would yield similar findings about why employees seek treatment versus not (benefits, care options, anonymity, work interference), but these results could be applied broadly and would not be subject to the limitations of the existing data set.  We certainly do hope that steps towards such research are being made.


# Figures

```{r echo=FALSE, out.width='100%'}
knitr::include_graphics('../Figures/Figure1.png')
knitr::include_graphics('../Figures/DataSummary.png')
knitr::include_graphics('../Figures/model1.png')
knitr::include_graphics('../Figures/model2.png')
knitr::include_graphics('../Figures/model3.png')


```


# Code
```{r, eval=FALSE, echo=TRUE}
if (!require('countrycode')) (install.packages('countrycode'))
if (!require('dplyr')) (install.packages('dplyr'))
if (!require('psych')) (install.packages('psych'))
if (!require('DataExplorer')) (install.packages('DataExplorer'))
if (!require('lubridate')) (install.packages('lubridate'))
url <- paste("https://raw.githubusercontent.com/",
"RaphaelNash/CUNY_DATA621_GroupProject/master/Data/survey_RAW.csv",
sep="")
df <-read.csv(url)
knitr::kable(head(df[,1:7]))
knitr::kable(head(df[,8:14]))
knitr::kable(head(df[,15:19]))
knitr::kable(head(df[,20:24]))
knitr::kable(head(df[,25:27]))

#comments
sample <- df[!(is.na(df$comments)), ]
head(sample$comments)
#timestamp
df$Timestamp <- ymd_hms(df$Timestamp)

##age
df <- df %>% filter(Age >= 18 | Age < 13 )
df$Age[df$Age > 100 | df$Age < 18 ] <- NA

##gender
df$Gender <- tolower(df$Gender)
df$Gender <- trimws(df$Gender)

### start with the obvious
cis_female_syn <- c("femail", "f", "woman", "femail", "female (cis)",
                    "cis female", "cis-female/femme", "femake", 
                    "female")
df$Gender[df$Gender %in% cis_female_syn] <- "female_cis"

cis_male_syn <- c("m", "man", "male (cis)", "male", "mal", "mail", 
                  "maile", "cis man", "cis male", "msle", "malr", 
                  "make")
df$Gender[df$Gender %in% cis_male_syn] <- "male_cis"

trans_female_syn <- c("trans woman", "trans-female", "female (trans)")
df$Gender[df$Gender %in% trans_female_syn] <- "female_trans"

genderqueer_syn <- c("non-binary", "enby", "queer", "queer/she/they",
                     "fluid", "androgyne", "agender", "neuter")
df$Gender[df$Gender %in% genderqueer_syn] <- "genderqueer"

fluid_syn <- c("male leaning androgynous", "male-ish", 
                   "ostensibly male, unsure what that really means", 
                   "something kinda male?", "guy (-ish) ^_^")
df$Gender[df$Gender %in% fluid_syn] <- "fluid"

unknown <- c("a little about you", "all", "p", "nah")
df$Gender[df$Gender %in% unknown] <- "unknown"

### Let's update some call out issues.   Obvs 967 reported "female" 
# in the Gender field, but noted being a trans woman in the comments.  
df$Gender[967] <- "female_trans"

df$Gender <- as.factor(df$Gender)
table(df$Gender)

#state
#Number of observations that aren't United States
nrow(df[df$Country != "United States",])

#Number of missing states
sum(is.na(df$state))

nrow(df[df$Country == "United States" & is.na(df$state),])

# there are 11 missing states.  
df$state <- as.character(df$state)
df$state[df$Country == "United States" & is.na(df$state)] <- "Unknown"

# Still some missing:   non-US countries w/ states?!
sub <- df[df$Country != "United States" & !is.na(df$state),]

knitr::kable(sub[, c("state", "Country")])

# Ok, that's weird.   Let's NA those
df$state[df$Country != "United States" & !is.na(df$state)] <- NA

df$state <- as.factor(df$state)
rm(sub)
df$continent <- as.factor(countrycode(sourcevar = df[, "Country"],
                                      origin = "country.name",
                                      destination = "continent"))
table(df$continent)

df$work_interfere <- as.character(df$work_interfere)
df$work_interfere[is.na(df$work_interfere)] <- "No Response"
df$work_interfere <- as.factor(df$work_interfere)

summary(df[, c("work_interfere", "self_employed", "Age")])

df <- df[!is.na(df$self_employed),]
df <- df[!is.na(df$Age),]

## Data Summary


summary <- describe(df[,c(2:26, 28)])[,c(2:5,8,9,11,12)]
knitr::kable(summary)

clean <- df
clean$Timestamp <- NULL
clean$comments <- NULL
clean$state <- NULL

out <- split_columns(clean)

plot_histogram(out$continuous)
plot_bar(out$discrete)


### Relationship of Predictors to Target:  "treatment"


plot_scatterplot(clean, "treatment", position = "jitter")

saveRDS(df, "../Data/MentalHealthCLEAN.rds")

Experimentation and Results
df = df[,!(names(df) %in% c("state", "comments", "Timestamp"))]
model1 <- glm(treatment ~. , data =df, family=binomial )
summary(model1)
model2 <- glm(treatment~ Age+Gender+ family_history+ work_interfere+family_history+benefits+care_options+anonymity+coworkers,  data =df, family=binomial )
summary(model2)
model3 <- glm(treatment~ work_interfere + benefits+ care_options+  anonymity , data =df, family=binomial )
summary(model3)
library(Deducer)
rocplot(model1)
rocplot(model2)
rocplot(model3)


```

# References

About OSMI (2017).  Retrieved from https://osmihelp.org/about/about-osmi.

Evens, J., et al. (2016).  Mental Illness Flourishes in High-Pressure Workplace. _Financial Times._  Retrieved from http://www.ft.com/content/d4168a70-4533-11e6-9b66-0712b3873ae1.

Harvard Health Publishing (2017). What Causes Depression.  _Harvard Health Blog_. Retrieved from www.health.harvard.edu/mind-and-mood/what-causes-depression.

International Labour Organisation (Gabriel, P., Riitta Liimatainen, M.) (2000).  _Mental Health in the Workplace: Introduction: Executive Summary_.  Retrieved from http://www.ilo.org/skills/pubs/WCMS_108221/lang--en/index.htm.

Kessler, R. C., Aguilar-Gaxiola, S., Alonso, J., Chatterji, S., Lee, S., Ormel, J., ...  Wang, P. S. (2009). The global burden of mental disorders: An update from the WHO World Mental Health (WMH) Surveys. _Epidemiologia E Psichiatria Sociale_, 18(1), 23-33. https://doi.org/10.1017/s1121189x00001421

Ma, J. O. & Cline, D. (2004). _Emergency medicine manual_. New York: McGraw-Hill, Medical Pub. Division.

Memish, K., Martin, A., Bartlett, L., Dawkins, S., & Sanderson, K. (2017). Workplace mental health: An international review of guidelines. _Preventive Medicine_, 101, 213-222. https://doi.org/10.1016/j.ypmed.2017.03.017

Milligan-Saville, J. S., Tan, L., Gayed, A., Barnes, C., Madan, I., Dobson, M., ... Harvey, S. B. (2017). Workplace mental health training for managers and its effect on sick leave in employees: a cluster randomised controlled trial. _The Lancet Psychiatry_, 4(11), 850-858. https://doi.org/10.1016/s2215-0366(17)30372-3.

National Institute of Mental Health, U.S. Department of Health and Human Services (2017).  _Mental Health_. Retrieved from www.nimh.nih.gov/health/statistics/mental-illness.shtml.

Open Sourcing Mental Illness (2017).  Retrieved from http://osmihelp.org.

Organisation for Economic Cooperation and Development (OECD). Employment Outlook 2013.  OECD Publishing, Paris. Retrieved from http://www.oecd-ilibrary.org.remote.baruch.cuny.edu/employment/oecd-employment-outlook-2013_empl_outlook-2013-en.

OSMI Mental Health in Tech Survey 2016 (2017).  Retrieved from https://www.kaggle.com/osmi/mental-health-in-tech-2016.

Page, K. M., LaMontagne, A. D., Louie, A. M., Ostry, A. S., Shaw, A., & Shoveller, J. A. (2013). Stakeholder perceptions of job stress in an industrialized country: Implications for policy and practice. Journal of Public Health Policy, 34(3), 447-461. https://doi.org/10.1057/jphp.2013.24

Research (2017).  Retrieved from https://osmihelp.org/research.

Talks & Videos (2017).  Retrieved from https://osmihelp.org/talks.



